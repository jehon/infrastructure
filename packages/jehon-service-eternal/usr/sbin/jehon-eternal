#!/usr/bin/env bash

# !! Must run as end-user

set -o errexit
set -o pipefail
shopt -s nullglob

_SD="$(dirname "$(realpath "${BASH_SOURCE[0]}")")"

# shellcheck source-path=SCRIPTDIR/../../../jehon/usr/bin/
. jh-lib

dcRoot=/usr/share/jehon-service-eternal/stack/
cmd="$1"

cd "${dcRoot}"

case "${cmd}" in
"install")
    # docker compose pull --quiet
    # # https://docs.docker.com/reference/cli/docker/compose/up/
    # docker compose up --build --detach --remove-orphans
    # docker image prune -f
    true
    ;;
"remove")
    docker compose down -f
    ;;
*)
    docker compose "$@"
    ;;
esac

jh-docker-clean
