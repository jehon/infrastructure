#!/usr/bin/env bash

set -o errexit
set -o pipefail

# shellcheck source-path=SCRIPTDIR/../bin/
. jh-stack-lib

if [ ! -r "${stackRoot}" ]; then
    jh_fatal "No stack found"
fi

header_begin "Update git"
# We need to do that before the jh-runner
# to get the latests scripts
cd "${stackRoot}"

if [ ! -r .git ]; then
    jh_fatal "No git repository found"
fi

git fetch
git reset --hard origin
header_end

header_begin "Running the cron"
jh-runner "${stackRoot}"/cron
header_end
