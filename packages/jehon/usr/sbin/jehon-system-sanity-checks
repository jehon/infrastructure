#!/usr/bin/env bash

set -o errexit
set -o pipefail
shopt -s nullglob

_SD="$(dirname "$(realpath "${BASH_SOURCE[0]}")")"

clear

# systemctl daemon-reload
systemctl reset-failed

# shellcheck disable=SC2155 # to allow copy-paste
export defaultTarget="$(systemctl get-default)"

systemd-analyze verify "${defaultTarget}"

systemctl list-units --state=failed

# systemctl list-jobs

systemctl list-dependencies "${defaultTarget}"

systemctl --state=not-found

echo "Dead links: "
find /etc/systemd -xtype l -printf '%p => %l\n'
find /usr/lib/systemd -xtype l -printf '%p => %l\n'
