#!/usr/bin/env bash

set -o errexit

file="${1:? file as [1]}"
key="${2:?key as [2]}"
val="$3" # Can be empty

if [ ! -r "${file}" ]; then
    touch "${file}"
fi

content="$(cat "$file")"

if grep "$key=" "$file" >&/dev/null; then
    echo "$content" | sed "/^${key}=/s/=.*/=""\"${val}\"""/" >"$file"
else
    echo "$key=\"$val\"" >>"$file"
fi
