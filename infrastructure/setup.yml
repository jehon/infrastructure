---
# https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html

#
# We need to pass through all this for handlers to run only once
#

- name: Setup systems
  hosts: all
  tasks:
    - name: Setup jh_01_basis
      ansible.builtin.include_role:
        name: jh_01_basis

    - name: Setup host dev
      when: inventory_hostname == "dev"
      loop_control:
        loop_var: include_role
      loop:
        - jh_02_user_dev
        - host_dev
      ansible.builtin.include_role:
        name: "{{ include_role }}"

    - name: Setup host kiosk
      when: inventory_hostname == "kiosk"
      loop_control:
        loop_var: include_role
      loop:
        - host_kiosk
      ansible.builtin.include_role:
        name: "{{ include_role }}"

    - name: Setup host vps
      when: inventory_hostname == "vps"
      loop_control:
        loop_var: include_role
      loop:
        - jh_02_user_dev
        - host_vps
      ansible.builtin.include_role:
        name: "{{ include_role }}"
